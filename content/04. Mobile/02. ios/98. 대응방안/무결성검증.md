
owasp 
https://github.com/OWASP/owasp-mastg/blob/master/Document/0x06j-Testing-Resiliency-Against-Reverse-Engineering.md#file-integrity-checks


https://mobile-security.gitbook.io/mobile-security-testing-guide/ios-testing-guide/0x06j-testing-resiliency-against-reverse-engineering#file-integrity-checks


https://seo-security.tistory.com/21

솔루션
https://github.com/olxios/SmartSec_iOS_Security/blob/master/README.md


경표주임님 

```
func requestGetIntegrety(event: @escaping (Result<[String], Error>) -> Void) {

        AF.request(BASE_URL + "app/certno/getObj", method: .post, parameters: nil, encoding: URLEncoding.default, headers: nil).responseString { response in

            print("requestGetIntegrety \(String(describing: response.response?.statusCode))")

            switch response.result {

            case .success(let result):

                event(.success([result]))

            case .failure(let error):

                event(.failure(error))

            }

        }

    }

    

    // MARK: 무결설 체크 해시 가져오기

    func requestSetIntegrety(appCertno: String, event: @escaping (Result<[String], Error>) -> Void) {

        let parameter = [

            "appCertno": appCertno

        ]

        

        AF.request(BASE_URL + "app/certno/save", method: .post, parameters: parameter, encoding: URLEncoding.default, headers: nil).responseString { response in

            print("requestSetIntegrety \(String(describing: response.response?.statusCode))")

            switch response.result {

            case .success(let result):

                event(.success([result]))

            case .failure(let error):

                event(.failure(error))

            }

        }

    }
```


# 1. chatgpt 

## 1.1 즉시 사용 및 삭제

사용자가 입력한 데이터를 즉시 처리하고, 필요한 경우에만 데이터를 사용하여 즉시 메모리에서 삭제하는 방법을 채택할 수 있습니다.

**TextField 입력 값 저장 및 즉시 사용:**
```
import UIKit

class ViewController: UIViewController, UITextFieldDelegate {
    @IBOutlet weak var textField: UITextField!

    override func viewDidLoad() {
        super.viewDidLoad()
        
        // UITextFieldDelegate를 설정하여 텍스트 필드 이벤트를 감지
        textField.delegate = self
    }

    // 텍스트 필드에서 텍스트가 변경될 때 호출되는 메서드
    func textField(_ textField: UITextField, shouldChangeCharactersIn range: NSRange, replacementString string: String) -> Bool {
        // 입력된 텍스트를 즉시 사용
        let currentText = textField.text ?? ""
        let newText = (currentText as NSString).replacingCharacters(in: range, with: string)
        
        // 여기에서 newText를 사용하여 필요한 로직을 수행
        print("입력된 텍스트: \(newText)")
        
        // 필요한 경우 즉시 사용한 데이터를 메모리에서 삭제
        textField.text = "" // 입력된 텍스트를 삭제

        return true
    }
}

```

**메모리에서 데이터 삭제:**
```
// UserDefaults를 사용하여 데이터를 저장하고, 즉시 사용 및 삭제하는 예제

// 데이터 저장
let userInput = "User's input"
UserDefaults.standard.set(userInput, forKey: "savedInput")

// 데이터 즉시 사용
if let savedInput = UserDefaults.standard.string(forKey: "savedInput") {
    print("저장된 데이터: \(savedInput)")

    // 필요한 로직을 수행한 후, 데이터를 즉시 삭제
    UserDefaults.standard.removeObject(forKey: "savedInput")
} else {
    print("데이터를 찾을 수 없음")
}

```


## 1.2. 암호화된 저장
: 필요한 경우에만 입력 데이터를 암호화하여 저장하고, 사용이 완료되면 해당 데이터를 삭제할 수 있습니다.

**CryptoKit을 사용하여 암호화 키 생성 및 데이터 암호화:**
```
import CryptoKit

func encryptText(_ text: String, key: SymmetricKey) throws -> Data {
    let plaintext = Data(text.utf8)
    let sealedBox = try AES.GCM.seal(plaintext, using: key)
    return sealedBox.combined!
}

func decryptText(_ data: Data, key: SymmetricKey) throws -> String {
    let sealedBox = try AES.GCM.SealedBox(combined: data)
    let decryptedData = try AES.GCM.open(sealedBox, using: key)
    return String(data: decryptedData, encoding: .utf8) ?? ""
}

```

**사용자 입력을 받아 암호화된 형태로 저장:**
```
// 키 생성
let encryptionKey = SymmetricKey(size: .bits256)

// 사용자 입력
let userInput = "User's input"

// 입력을 암호화하여 저장
do {
    let encryptedData = try encryptText(userInput, key: encryptionKey)
    // 암호화된 데이터를 저장하거나 다른 처리를 수행
    // 예: UserDefaults, CoreData, 서버에 전송 등
} catch {
    // 암호화 실패 시 예외 처리
    print("Encryption error: \(error.localizedDescription)")
}

```

위 코드에서 사용된 `SymmetricKey`는 암호화와 복호화에 사용되는 키입니다. 이 키는 안전하게 보관되어야 합니다. 사용자의 입력을 받은 후 이 키를 사용하여 데이터를 암호화하고, 암호화된 데이터를 저장하거나 다른 처리를 수행할 수 있습니다.

## 1.3 임시 메모리 사용:
입력 데이터를 처리하기 위해 임시 메모리를 사용하고, 해당 작업이 완료되면 명시적으로 메모리를 해제하는 방법을 고려할 수 있습니다.

```
var temporaryData: String?

temporaryData = nil //nil로 메모리에서 제거 
```

## 1.4 메모리 권한 관리:
iOS에서는 메모리 권한을 관리할 수 있는 다양한 기능을 제공하므로, 필요한 경우 해당 부분을 적절하게 제한하여 민감한 정보를 보호할 수 있습니다.

